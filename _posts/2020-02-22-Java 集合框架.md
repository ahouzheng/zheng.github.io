---
title: Java 集合框架
auther: ahou
layout: post
---

## 常见集合类
**Map接口和Collection接口是所有集合的父接口  
其中Collection接口是List接口和Set接口的父接口**  
Map接口的实现类有: HashMap，Hashtable，LinkedHashMap，TreeMap,ConcurrentHashMap
List接口的实现类有：ArrayList，LinkedList，Stack，Vector
Set接口的实现类有：HashSet，TreeSet，LinkedHashSet


## HashMap和Hashtable的区别
1. 线程安全
2. 是否允许key和value中的null
3. 继承的父类 AbstractMap  Dictionary

## 为何HashMap中String，Integer类型适合作为Key
1. 其中数据的不变性（final修饰），不会出现hash值变化的情况
2. 已经重写了equals方法和hashCode方法，不容易出现hash值错误
如果需要以自己定义的Object作为key，需要重写equals和hashCode方法保证其符合一般原则
1). equals判断相等的对象，hashCode值必须相同
2). equals判断不相等的对象，hashCode值不要求必须不同，单位了保证更好的散列效果，期望不同
3). 一次运行中，同一个对象多次计算的hashCode值必须相同，多次运行之间可以不同

## ConcurrentHashMap和Hashtable的区别
它们都是现成安全的，但ConcurrentHashMap的效率比Hashtable更高  
ConcurrentHashMap把HashMap分为多个segment，其中每个segment使用一个可重入锁ReentrantLock，相当于一个小的Hashtable，这使得访问不同segment的线程可以并发进行，同时保证线程安全。  
在Java8中，ConcurrentHashMap取消了segment这一层设计，实现了更细粒度的加锁，直接把锁加在数组元素上，可以支持更高的并发量。  

## ArrayList和Vector的区别
ArrayList和Vector都是List的实现类，都属于有序列表
1. 同步性，Vector是线程安全的，ArrayList不是
2. 扩容机制，ArrayList在元素超过容量的0.5倍时，扩容为原来的1.5倍；Vector在满时在进行扩容，扩容为原来的2倍。

## 集合框架中的默认值
#### HashMap
默认数组容量16，扩容阈值因子0.75，扩容阈值（16*0.75），扩容后容量翻倍  
当链表中元素超过8时，链表转化为红黑树  

#### ArrayList
数组内容达到容量的0.5倍时(加载因子0.5)，扩容为原来的1.5倍

#### Vector
数组内容满时扩容为原来的2倍

ArrayList  
LinkedList  

HashMap  
Hashtable  
ConcurrentHashMap  

HashSet  

LinkedHashMap  
LinkedHashSet  

## Fail-Fast和Fail-Safe机制