---
title: web 框架
auther: ahou
layout: post
---

## Nginx

#### Nginx负载均衡
- 根据权重确定随机选中概率
- IP hash，根据IP的Hash值对应到服务器，保证同一个IP总能由同一个服务器提供服务，可以解决session共享问题
- url hash，根据url的Hash值对应到服务器，同一个地址访问总由同一个服务器响应，缓存效率更高

## Dubbo Dubbox
**参考文章：[dubbo负载均衡与容错](https://www.cnblogs.com/xhj123/p/9087532.html)**
#### Dubbo 容错
- Failover，失败重试，设定最大重试次数
- Failfast，快速失败，失败了之后，立即报错
- Failsafe，调用出现异常时，直接忽略，这种模式可以用于写入日志
- Forking 有请求是同时向多个提供者发出请求，只要有一个成功返回就算是成功调用，浪费资源，用于实时性要求比较高的场合
Dubbo的容错机制还可以定制

#### Dubbo负载均衡
**参考文章：[dubbo四种负载均衡策略](https://blog.csdn.net/qq_23864915/article/details/90524467?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task)
**
- Random，权重随机，根据权重确定随机选中概率
- RoundRobin，轮询，基于加权的轮训算法，在轮询时，它们收到的请求数接近或等于它们的权重比。
- LeastActive，最少活跃调用，请求优先分配给活跃数小的服务提供者。刚开始每台提供者的活跃数都为0，每收到一个请求，活跃数加1。最小的活跃数有多个提供者时，根据权重确定选择谁。
- ConsistentHash，一致性hash，根据参数hash确定分配，相同参数的请求总是发到同一个提供者，缺省只对第一个参数hash，当某一台机器挂了，根据虚拟节点把请求平摊给其他提供者，不会给系统带来很大的震荡。

#### Dubbo与Spring Cloud 比较
- dubbo 传输远快于springcloud  
- dubbo服务提供方与调用方接口依赖方式太强：我们为每个微服务定义了各自的service抽象接口，并通过持续集成发布到私有仓库中，调用方应用对微服务提供的抽象接口存在强依赖关系
springcloud REST调用方式相比RPC更为轻量化，服务提供方和调用方的依赖只是依靠一纸契约，不存在代码级别的强依赖。